{
    "matches": {
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/shared_lib/Shared_Lib.hh": "//----------------------------------*-C++-*----------------------------------//\n/*!\n * \\file   shared_lib/Shared_Lib.hh\n * \\author Rob Lowrie\n * \\date   Thu Apr 15 20:44:39 2004\n * \\brief  Header file for Shared_Lib.\n * \\note   Copyright (C) 2016-2019 Triad National Security, LLC.\n */\n//---------------------------------------------------------------------------//\n\n#ifndef rtt_shared_lib_Shared_Lib_hh\n#define rtt_shared_lib_Shared_Lib_hh\n\n#include <shared_lib/config.h>\n\n#include <ds++/Assert.hh>\n#include <string>\n\nnamespace rtt_shared_lib {\n\n//===========================================================================//\n/*!\n  \\class Shared_Lib\n  \\brief Controls access to a shared (dynamically linked) library.\n\n  Access to functions defined in the shared library is provided via the\n  get_function() member.\n\n  Under Draco, not all platforms support dynamic loading of shared libraries.\n  Consequently, in order to write cross-platform code, one must use the\n  static member function is_supported() to check whether the functionality of\n  Shared_Lib is supported.  As an example,\n  \\code\n  if ( Shared_Lib::is_supported() )\n  {\n     // OK, Shared_Lib is supported.\n     Shared_Lib s;\n     s.open(\"/usr/lib/libm.so\");\n     // ... other operations using s.\n  }\n  else\n  {\n     // Shared_Lib is unsupported!\n     Shared_Lib s;               // throws an error!!!\n     s.open(\"/usr/lib/libm.so\"); // won't get this far.\n  }\n  \\endcode\n  Note that the above code should compile on all platforms, but on\n  unsupported platforms, the \"else\" block will throw an error at run time.\n */\n/*!\n * \\example shared_lib/test/tstShared_Lib.cc\n *\n * This example shows how classes may be created through shared objects.\n*/\n//===========================================================================//\n\nclass Shared_Lib {\n  // DATA\n\n  // The handle to the shared library.\n  void *d_handle;\n\n  // The name of the shared library.\n  std::string d_file_name;\n\npublic:\n  // Default constructor.\n  explicit Shared_Lib(const std::string &file_name = \"\");\n\n  // Copy constructor.\n  explicit Shared_Lib(const Shared_Lib &from);\n\n  //! Destructor.  Automatically closes the shared library.\n  ~Shared_Lib() { close(); }\n\n  // Assignment.\n  Shared_Lib &operator=(const Shared_Lib &rhs);\n\n  // Closes the shared library.\n  void close();\n\n  //! Returns a handle to the shared library.\n  void *get_handle() const {\n    Require(is_open());\n    return d_handle;\n  }\n\n  //! Returns the shared file name.\n  std::string get_file_name() const { return d_file_name; }\n\n  // Returns a function pointer from the shared library.\n  template <class Fp_t> inline Fp_t get_function(const std::string &name);\n\n  //! Returns true if library is open.\n  bool is_open() const { return d_handle; }\n\n  //! Returns true if platform is supported.\n  static bool is_supported();\n\n  // Opens a shared library.\n  void open(const std::string &file_name);\n\nprivate:\n  // Does the dlsym() with error checking.\n  void *do_dlsym(const std::string &name);\n};\n\n//---------------------------------------------------------------------------//\n// INLINE FUNCTIONS\n//---------------------------------------------------------------------------//\n\n//---------------------------------------------------------------------------//\n/*!\n  \\brief Returns a function pointer from the shared library.\n\n  The shared library must be opened before using this function.\n\n  \\param name The name of the function in the shared lib.\n  \\param Fp_t The function pointer type for the function \\a name.\n */\ntemplate <class Fp_t> Fp_t Shared_Lib::get_function(const std::string &name) {\n  Require(is_open());\n\n  // HACK WARNING: 5.2.10/6-7 implies that we cannot cast a\n  // pointer-to-object (in this case, the void* from dlsym) to a\n  // pointer-to-function.  If void* and Fp_t are different sizes, I suspect\n  // the hack below may not be portable. In the end, I suspect that platforms\n  // where this hack does not work don't support dlopen, anyway - lowrie\n\n  union {\n    void *vp;\n    Fp_t fp;\n  };\n  vp = do_dlsym(name);\n\n  return fp;\n}\n\n} // end namespace rtt_shared_lib\n\n#endif // rtt_shared_lib_Shared_Lib_hh\n\n//---------------------------------------------------------------------------//\n//              end of shared_lib/Shared_Lib.hh\n//---------------------------------------------------------------------------//\n",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/shared_lib/Shared_Lib.cc": "//----------------------------------*-C++-*----------------------------------//\n/*!\n * \\file   ds++/Shared_Lib.cc\n * \\author Rob Lowrie\n * \\date   Thu Apr 15 20:44:39 2004\n * \\brief  Implementation of Shared_Lib.\n * \\note   Copyright (C) 2016-2019 Triad National Security, LLC.\n */\n//---------------------------------------------------------------------------//\n\n#include \"Shared_Lib.hh\"\n#include \"dlfcn_support.hh\"\n#include <sstream>\n\nnamespace rtt_shared_lib {\n\n//---------------------------------------------------------------------------//\n/*!\n  \\brief Default constructor.\n\n  \\param file_name File name of the shared lib.  If empty, open() must be\n  called later in order to use a shared lib.\n*/\nShared_Lib::Shared_Lib(const std::string &file_name)\n    : d_handle(0), d_file_name(file_name) {\n  // is_supported must be checked for all constructors.\n  Insist(is_supported(), \"Shared_Lib unsupported on this platform!\");\n\n  if (!file_name.empty()) {\n    open(file_name);\n  }\n}\n\n//---------------------------------------------------------------------------//\n/*!\n  \\brief Copy constructor.\n\n  This is implemented by opening a new handle to the shared file.\n*/\nShared_Lib::Shared_Lib(const Shared_Lib &from)\n    : d_handle(0), d_file_name(std::string()) {\n  open(from.d_file_name);\n}\n\n//---------------------------------------------------------------------------//\n/*!\n  \\brief Assignment.\n\n  This is implemented by opening a new handle to the shared file.\n*/\nShared_Lib &Shared_Lib::operator=(const Shared_Lib &rhs) {\n  if (this == &rhs) {\n    return *this;\n  }\n\n  open(rhs.d_file_name);\n\n  return *this;\n}\n\n//---------------------------------------------------------------------------//\n/*!\n  \\brief Closes the shared library, if it is open.\n*/\nvoid Shared_Lib::close() {\n  if (is_open()) {\n    dlclose(d_handle);\n    d_handle = 0;\n  }\n}\n\n//---------------------------------------------------------------------------//\n/*!\n  \\brief Opens a shared library.\n\n  If a shared library is already open, that library is closed.\n\n  \\param file_name The name of the shared lib.\n*/\nvoid Shared_Lib::open(const std::string &file_name) {\n  Require(!file_name.empty());\n\n  close();\n\n  // RTLD_LAZY means symbols are resolved as they're needed.  We might want\n  // to make this an option, in the future.\n  d_handle = dlopen(file_name.c_str(), RTLD_LAZY);\n\n  d_file_name = file_name;\n\n  if (!is_open()) {\n    std::ostringstream m;\n    m << \"Shared_Lib::open(): Error opening shared file: \" << file_name;\n    m << \"\\ndlerror reports: \" << dlerror();\n    Insist(0, m.str());\n  }\n}\n\n//---------------------------------------------------------------------------//\n// PRIVATE FUNCTIONS\n//---------------------------------------------------------------------------//\n\n//---------------------------------------------------------------------------//\n/*!\n  \\brief Does the dlsym() with error checking.\n\n  The primary point of this function is to keep the dlfcn.h functions called\n  within this implementation file, while this function can be called from\n  within the header (i.e., within get_function()).\n\n  \\param name The name of function to load from the library.\n*/\nvoid *Shared_Lib::do_dlsym(const std::string &name) {\n  Require(is_open());\n  Require(!name.empty());\n\n  void *f = dlsym(d_handle, name.c_str());\n\n  const char *error_msg = dlerror();\n  if (error_msg) {\n    std::ostringstream m;\n    m << \"Shared_Lib::do_dlsym(): Error accessing symbol '\" << name;\n    m << \"' from file \" << d_file_name;\n    m << \"\\ndlerror reports: \" << error_msg;\n    Insist(0, error_msg);\n  }\n\n  return f;\n}\n\n} // end namespace rtt_shared_lib\n\n//---------------------------------------------------------------------------//\n//                 end of Shared_Lib.cc\n//---------------------------------------------------------------------------//\n",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/shared_lib/dlfcn_support.hh": "//----------------------------------*-C++-*----------------------------------//\n/*!\n * \\file   shared_lib/dlfcn_supported.hh\n * \\author Rob Lowrie\n * \\date   Thu Apr 15 20:44:39 2004\n * \\brief  Logic for dlfcn.h system header.\n * \\note   Copyright (C) 2016-2019 Triad National Security, LLC.\n *         All rights reserved.\n */\n//---------------------------------------------------------------------------//\n\n//---------------------------------------------------------------------------//\n\n#ifndef rtt_shared_lib_dlfcn_supported_hh\n#define rtt_shared_lib_dlfcn_supported_hh\n\n// This header isolates the use of the macro NO_DLOPEN for Shared_Lib.\n// It defines Shared_Lib::is_supported(), and whether the platform is\n// supported or not, defines the system functions.\n\n#ifdef USE_DLOPEN\n\n// ... then dynamic loading of shared libraries is supported.\n\n// Load the system header.\n\n#include <dlfcn.h>\n\nbool rtt_shared_lib::Shared_Lib::is_supported() { return true; }\n\n#else\n\n// ... then dynamic loading of shared libraries is unsupported.\n\nbool rtt_shared_lib::Shared_Lib::is_supported() { return false; }\n\n// Define dlfcn function stubs and constants so that Shared_Lib will compile.\n\nstatic const int RTLD_LAZY = 1; // or whatever.\n\nvoid *dlopen(const char * /*filename*/, int /*flag*/) {\n  Insist(0, \"Serious Shared_Lib error.\");\n  void *dummy(0);\n  return dummy;\n}\n\nconst char *dlerror(void) {\n  Insist(0, \"Serious Shared_Lib error.\");\n  return \"dummy\";\n}\n\nvoid *dlsym(void * /*handle*/, const char * /*symbol*/) {\n  Insist(0, \"Serious Shared_Lib error.\");\n  void *dummy(0);\n  return dummy;\n}\n\nint dlclose(void * /*handle*/) {\n  Insist(0, \"Serious Shared_Lib error.\");\n  return 1;\n}\n\n#endif // USE_DLOPEN\n\n#endif // rtt_shared_lib_dlfcn_supported_hh\n\n//---------------------------------------------------------------------------//\n// end of shared_lib/dlfcn_supported.hh\n//---------------------------------------------------------------------------//\n"
    },
    "skipped": [
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/special_functions/autodoc/angular_coordinate_system.jpg",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/c4/doc/TigsTrace_accumulatev.vsd",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/c4/doc/TigsTrace_accumulatev.pdf",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/bench/Pressure.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/bench/Densities.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/bench/geo.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/bench/Velocity.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/bench/Temperatures.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/unstr2d_bench/Pressure.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/unstr2d_bench/Densities.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/unstr2d_bench/geo.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/unstr2d_bench/Velocity.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/viz/test/unstr2d_bench/Temperatures.bin.0001",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/cdi_ipcress/test/odfregression10.ipcress",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/cdi_ipcress/test/analyticOpacities.ipcress",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/cdi_ipcress/test/Al_BeCu.ipcress",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/cdi_ipcress/doc/IPCRESS_File _Format.vsd",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/cdi_ipcress/doc/IPCRESS_File_Format.pdf",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/RTT_Format_Reader/autodoc/stdcell.jpg",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/RTT_Format_Reader/doc/stdcell.jpg",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/src/cdi/doc/CDI Overview.ps.gz",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/autodoc/html/dragon.jpg",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/autodoc/html/dragon-r.jpg",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/autodoc/html/draco_package_level_diagram.jpg",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/autodoc/html/doxygen.png",
        "/tmp/vanessa/spack-stage/spack-stage-draco-7.1.0-io2b5md7ce7itc77xaokuqjyv3c66sm3/spack-src/environment/templates/CCS4seminar/example.pdf"
    ],
    "total_files": 1162
}