{
    "matches": {
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/os/dl.c": "// This is an open source non-commercial project. Dear PVS-Studio, please check\n// it. PVS-Studio Static Code Analyzer for C, C++ and C#: http://www.viva64.com\n\n/// Functions for using external native libraries\n\n#include <stdbool.h>\n#include <stdint.h>\n#include <uv.h>\n\n#include \"nvim/os/dl.h\"\n#include \"nvim/os/os.h\"\n#include \"nvim/memory.h\"\n#include \"nvim/message.h\"\n\n/// possible function prototypes that can be called by os_libcall()\n/// int -> int\n/// int -> string\n/// string -> string\n/// string -> int\ntypedef void (*gen_fn)(void);\ntypedef const char *(*str_str_fn)(const char *str);\ntypedef int (*str_int_fn)(const char *str);\ntypedef const char *(*int_str_fn)(int64_t i);\ntypedef int (*int_int_fn)(int64_t i);\n\n/// os_libcall - call a function in a dynamic loadable library\n///\n/// an example of calling a function that takes a string and returns an int:\n///\n///   int int_out = 0;\n///   os_libcall(\"mylib.so\", \"somefn\", \"string-argument\", 0, NULL, &int_out);\n///\n/// @param libname the name of the library to load (e.g.: libsomething.so)\n/// @param funcname the name of the library function (e.g.: myfunc)\n/// @param argv the input string, NULL when using `argi`\n/// @param argi the input integer, not used when using `argv` != NULL\n/// @param[out] str_out an allocated output string, caller must free if\n///             not NULL. NULL when using `int_out`.\n/// @param[out] int_out the output integer param\n/// @return true on success, false on failure\nbool os_libcall(const char *libname,\n                const char *funcname,\n                const char *argv,\n                int64_t argi,\n                char **str_out,\n                int *int_out)\n{\n  if (!libname || !funcname) {\n    return false;\n  }\n\n  uv_lib_t lib;\n\n  // open the dynamic loadable library\n  if (uv_dlopen(libname, &lib)) {\n      EMSG2(_(\"dlerror = \\\"%s\\\"\"), uv_dlerror(&lib));\n      uv_dlclose(&lib);\n      return false;\n  }\n\n  // find and load the requested function in the library\n  gen_fn fn;\n  if (uv_dlsym(&lib, funcname, (void **) &fn)) {\n      EMSG2(_(\"dlerror = \\\"%s\\\"\"), uv_dlerror(&lib));\n      uv_dlclose(&lib);\n      return false;\n  }\n\n  // call the library and save the result\n  // TODO(aktau): catch signals and use jmp (if available) to handle\n  // exceptions. jmp's on Unix seem to interact trickily with signals as\n  // well. So for now we only support those libraries that are well-behaved.\n  if (str_out) {\n    str_str_fn sfn = (str_str_fn) fn;\n    int_str_fn ifn = (int_str_fn) fn;\n\n    const char *res = argv ? sfn(argv) : ifn(argi);\n\n    // assume that ptr values of NULL, 1 or -1 are illegal\n    *str_out = (res && (intptr_t) res != 1 && (intptr_t) res != -1)\n        ? xstrdup(res) : NULL;\n  } else {\n    str_int_fn sfn = (str_int_fn) fn;\n    int_int_fn ifn = (int_int_fn) fn;\n    *int_out = argv ? sfn(argv) : ifn(argi);\n  }\n\n  // free the library\n  uv_dlclose(&lib);\n\n  return true;\n}\n"
    },
    "skipped": [
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/cs.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/ja.euc-jp.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/sk.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/cs.cp1250.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/ca.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/sk.cp1250.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/ga.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/sv.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/nb.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/it.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/no.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/pt_BR.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/af.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/fr.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/po/de.po",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/testdir/test_increment_dbcs.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/testdir/test_spell.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/testdir/test_regexp_latin.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/testdir/test42.ok",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/testdir/test_regex_char_classes.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/src/nvim/testdir/test42.in",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/.git/objects/pack/pack-0517a21d38b2883bb72b9fc1ca24cb7a9aa00779.idx",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/.git/objects/pack/pack-0517a21d38b2883bb72b9fc1ca24cb7a9aa00779.pack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/nvim.png",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/moo.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/tilde.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/pascal.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/rtf.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/groff.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/lout.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/forth.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/nroff.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/css.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/rpl.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/fortran.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/initng.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/iss.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/mmix.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/elf.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/syntax/robots.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/ftplugin/ocaml.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/ftplugin/rpl.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/ftplugin/erlang.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/hebrewp_utf-8.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/greek_cp737.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/canfr-win.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/serbian_cp1251.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/slovak_iso-8859-2.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/greek_iso-8859-7.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/hebrew_iso-8859-8.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/serbian_iso-8859-5.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/accents.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/serbian_cp1250.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/esperanto_utf-8.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/croatian_iso-8859-2.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/serbian_iso-8859-2.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/greek_utf-8.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/croatian_cp1250.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/greek_cp1253.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/hebrewp_cp1255.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/keymap/slovak_cp1250.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/indent/tilde.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/indent/rpl.vim",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/doc/spell.txt",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/doc/mlang.txt",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/doc/makehtml.awk",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/runtime/spell/en.utf-8.spl",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/legacy/093_mksession_cursor_cols_latin1_spec.lua",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/legacy/044_099_regexp_multibyte_magic_spec.lua",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/api_level_2.mpack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/api_level_0.mpack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/shell_data.txt",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/api_level_6.mpack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/api_level_3.mpack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/api_level_4.mpack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/api_level_1.mpack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/test/functional/fixtures/api_level_5.mpack",
        "/tmp/vanessa/spack-stage/spack-stage-neovim-stable-kw34bcizibq2io7tag4j7jjw3r2xr2i4/spack-src/contrib/doxygen/logo-devdoc.png"
    ],
    "total_files": 2546
}