{
    "matches": {
        "/tmp/vanessa/spack-stage/spack-stage-py-pygpu-0.7.2-yaico5l6inqahe4eeetlkuviiomqgdpy/spack-src/src/loaders/dyn_load.c": "#include \"dyn_load.h\"\n#include \"util/error.h\"\n\n#if defined(__unix__) || defined(__APPLE__)\n\n#include <dlfcn.h>\n#include <err.h>\n#include <stddef.h>\n#include <stdlib.h>\n#include <string.h>\n\nvoid *ga_load_library(const char *name, error *e) {\n  void *res = dlopen(name, RTLD_LAZY|RTLD_LOCAL);\n  if (res == NULL)\n    error_fmt(e, GA_LOAD_ERROR, \"Could not load \\\"%s\\\": %s\", name, dlerror());\n  return res;\n}\n\nvoid *ga_func_ptr(void *h, const char *name, error *e) {\n  void *res = dlsym(h, name);\n  if (res == NULL)\n    error_fmt(e, GA_LOAD_ERROR, \"Could not find symbol \\\"%s\\\": %s\", name, dlerror());\n  return res;\n}\n\n#else\n\n/* Should be windows */\n#include <windows.h>\n\nstatic inline void error_win(const char* name, error *e) {\n  char msgbuf[512];\n  DWORD err = GetLastError();\n  DWORD len = FormatMessageA(FORMAT_MESSAGE_FROM_SYSTEM|\n                             FORMAT_MESSAGE_IGNORE_INSERTS,\n                             NULL, err, 0, msgbuf, 512, NULL);\n  if (len == 0)\n    error_fmt(e, GA_LOAD_ERROR, \"Could not load \\\"%s\\\": error code %X\", name, err);\n  else\n    error_fmt(e, GA_LOAD_ERROR, \"Could not load \\\"%s\\\": %s\", name, msgbuf);\n}\n\nvoid *ga_load_library(const char *name, error *e) {\n  void *res = LoadLibrary(name);\n  if (res == NULL)\n    error_win(name, e);\n  return res;\n}\n\nvoid *ga_func_ptr(void *h, const char *name, error *e) {\n  void *res = (void *)GetProcAddress(h, name);\n  if (res == NULL)\n    error_win(name, e);\n  return res;\n}\n\n#endif\n"
    },
    "skipped": [],
    "total_files": 205
}