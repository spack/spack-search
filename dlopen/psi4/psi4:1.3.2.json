{
    "matches": {
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/psi4/src/psi4/libplugin/load_plugin.cc": "/*\n * @BEGIN LICENSE\n *\n * Psi4: an open-source quantum chemistry software package\n *\n * Copyright (c) 2007-2019 The Psi4 Developers.\n *\n * The copyrights for code used from other parties are included in\n * the corresponding files.\n *\n * This file is part of Psi4.\n *\n * Psi4 is free software; you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, version 3.\n *\n * Psi4 is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License along\n * with Psi4; if not, write to the Free Software Foundation, Inc.,\n * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n *\n * @END LICENSE\n */\n\n#include \"plugin.h\"\n\n#include <algorithm>\n#include <cctype>\n\n#include \"psi4/libfilesystem/path.h\"\n#include \"psi4/liboptions/liboptions.h\"\n#include \"psi4/libpsi4util/PsiOutStream.h\"\n#include \"psi4/libpsi4util/process.h\"\n#include \"psi4/libpsio/psio.hpp\"\n\nnamespace psi {\n#ifdef HAVE_DLFCN_H\n\n#include <dlfcn.h>\n\nplugin_info plugin_load(std::string &plugin_pathname) {\n    plugin_info info;\n\n    info.plugin_handle = dlopen(plugin_pathname.c_str(), RTLD_LAZY);\n    if (info.plugin_handle == nullptr) {\n        std::string msg = \"load_plugin: Cannot open library: \";\n        msg += dlerror();\n        throw PSIEXCEPTION(msg);\n    }\n\n    info.read_options = (read_options_t)dlsym(info.plugin_handle, \"read_options\");\n    const char *dlsym_error2 = dlerror();\n    if (dlsym_error2) {\n        dlclose(info.plugin_handle);\n        std::string msg = \"load_plugin: Cannot find symbol: read_options; \";\n        msg += dlsym_error2;\n        throw PSIEXCEPTION(msg);\n    }\n\n    info.name = filesystem::path(plugin_pathname).stem();\n\n    // Modify info.name converting things that are allowed\n    // filename characters to allowed C++ function names.\n    // Replace all '-' with '_'\n    std::transform(info.name.begin(), info.name.end(), info.name.begin(), [](char c) { return c == '-' ? '_' : c; });\n\n    info.plugin = (plugin_t)dlsym(info.plugin_handle, info.name.c_str());\n    const char *dlsym_error3 = dlerror();\n    if (dlsym_error3) {\n        dlclose(info.plugin_handle);\n        std::string msg = \"load_plugin: Cannot find symbol: \";\n        msg += info.name;\n        msg += dlsym_error3;\n        throw PSIEXCEPTION(msg);\n    }\n\n    // Uppercase and store the name of the plugin for read_options\n    std::transform(info.name.begin(), info.name.end(), info.name.begin(), [](unsigned char c) { return std::toupper(c); });\n\n    // Get the plugin's options into the global space\n    Process::environment.options.set_read_globals(true);\n    info.read_options(info.name, Process::environment.options);\n    Process::environment.options.set_read_globals(false);\n\n    return info;\n}\n\n#else\n\nplugin_info plugin_load(std::string& plugin_path) {\n    throw PSIEXCEPTION(\"Plugins are not supported on your platform.\\n\");\n    return plugin_info();\n}\n\n#endif\n}\n"
    },
    "skipped": [
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/VC.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/DFA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/dDB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/VA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/VB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/DFB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/dDA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/DA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/Geom.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/DC.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt2/plot-ref/DB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/VC.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/DFA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/dDB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/VA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/VB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/DFB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/dDA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/DA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/Geom.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/DC.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/isapt1/plot-ref/DB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/pytest/data_dft-bench/qchem_cation_dsd_data.tar.gz",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt-diff1/fsaptD-ref/Elst.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt-diff1/fsaptD-ref/Total.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt-diff1/fsaptD-ref/Geom.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt-diff1/fsaptD-ref/IndAB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt-diff1/fsaptD-ref/Disp.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt-diff1/fsaptD-ref/IndBA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt-diff1/fsaptD-ref/Exch.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt1/fsapt-ref/Elst.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt1/fsapt-ref/Total.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt1/fsapt-ref/Geom.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt1/fsapt-ref/IndAB.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt1/fsapt-ref/Disp.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt1/fsapt-ref/IndBA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/tests/fsapt1/fsapt-ref/Exch.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/media/psi4banner.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/media/psi4banner.pdf",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/media/psi4square.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/media/psi4square.pdf",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/conda/win/2019.1/libiomp5md.lib",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/psi4/src/psi4/adc/sigma.pdf",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/psi4/share/psi4/quadratures/1_x/R_avail.little.bin",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/psi4/share/psi4/quadratures/1_x/error.big.bin",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/psi4/share/psi4/quadratures/1_x/error.little.bin",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/psi4/share/psi4/quadratures/1_x/R_avail.big.bin",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/favicon-psi4.ico",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/VA.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/psi4square.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/Total.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/prflow.001.jpeg",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/favicon-psi4.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/prflow.003.jpeg",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/gdma-2.2.06.pdf",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/AlphaMOs.png",
        "/tmp/vanessa/spack-stage/spack-stage-psi4-1.3.2-3svp3pa3pcjbwhxob55y6h52sft4zaeo/spack-src/doc/sphinxman/source/resources/prflow.002.jpeg"
    ],
    "total_files": 6094
}